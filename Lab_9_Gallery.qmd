---
title: "Generative Art"
author: "Nick Soares"
format: html
editor: visual
---

```{r}
#| warning: false
#| echo: false
#| label: load-packages-and-data

library(tidyverse)
library(ggthemes)
library(scales)
library(ambient)

#phytoplankton monitoring time series from Morro Bay
hab <- read.csv("data/MBF_upload.csv")
```

## Art Piece 1

```{r}
#| warning: false
#| label: building-art-one

#exploring color palettes
sample_canva <- function(seed = NULL) {
  if(!is.null(seed)) set.seed(seed)
  sample(ggthemes::canva_palettes, 1)[[1]]
}
myPal <- sample_canva(seed = 80)
show_col(myPal)


#exploring different values and plots
hab |>
  ggplot(aes(Temp..deg.C., 
             sqrt(Total.Phytoplankton..cells.L.), 
             colour = Day.of.Year..1.365., 
             size = Avg.Chloro..mg.m3.)) + 
  geom_point(show.legend = FALSE) + 
  coord_polar() + 
  theme_void() +
  scale_color_viridis_c()

hab |>
  ggplot(aes(Day.of.Year..1.365., 
             sqrt(Total.Phytoplankton..cells.L.), 
             colour  = Avg.Chloro..mg.m3.)) + 
  geom_bar(stat = "identity", 
           show.legend = FALSE) + 
  coord_polar() + 
  theme_void() +
  scale_color_viridis_c()

hab |>
  ggplot() +
  geom_point(aes(Day.of.Year..1.365., 
             log10(Total.Phytoplankton..cells.L.), 
             colour = Day.of.Year..1.365., 
             size = Avg.Chloro..mg.m3./2),
             show.legend = FALSE) +
  geom_point(aes(abs(366-Day.of.Year..1.365.), 
             log(Total.Phytoplankton..cells.L.), 
             colour = Day.of.Year..1.365., 
             size = Avg.Chloro..mg.m3.),
             show.legend = FALSE) +
  geom_bar(aes(Day.of.Year..1.365., 
              log10(Akashiwo.sanguinea..cells.L.), 
              colour  = Temp..deg.C.*20),
           stat = "identity", 
           show.legend = FALSE) +
  geom_bar(aes(Day.of.Year..1.365., 
              log10(Pseudo.nitzschia.seriata.group..cells.L.), 
              colour  = Temp..deg.C.*10),
           stat = "identity", 
           show.legend = FALSE) +
  coord_polar() + 
  theme_void() +
  scale_color_viridis_c()

#IDEAS
#maybe add a GIF component, add some spin by changing the polar coords (x+1 or something) with gganimate?

```

## Art Piece 2

```{r}
#| warning: false
#| label: building-art-two

#create a canvas
x_coords <- seq(from = 0, to = 1, length.out = 800)
y_coords <- seq(from = 0, to = 1, length.out = 800)
canvas <- long_grid(x = x_coords, y = y_coords) 

#add some generated "paint" to the canvas
canvas <- canvas |>
  mutate(paint = gen_simplex(x, y,
            frequency = 5,                 
            seed = 29))

#
art <- ggplot(canvas, aes(x, y, fill = paint)) + 
  geom_raster(show.legend = FALSE) +
  theme_void() +
  coord_equal() +
  scale_x_continuous(expand = c(0, 0)) +
  scale_y_continuous(expand = c(0, 0)) +
  scale_fill_gradientn(colours = sample_canva(seed = 42))


```
